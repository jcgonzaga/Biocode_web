---
import MainLayout from '../../layouts/MainLayout.astro';
import { supabase } from '../../lib/supabase';

const { id } = Astro.params;

if (!id) {
  return Astro.redirect('/404');
}

const { data: newsletter, error } = await supabase
  .from('newsletters')
  .select('subject, content_html')
  .eq('id', id)
  .single();

if (error || !newsletter) {
  console.error('Error fetching newsletter:', error);
  return Astro.redirect('/404');
}

const contentHtml = newsletter.content_html;
---

<MainLayout title={newsletter.subject}>
  <div class="max-w-4xl mx-auto">
    <a href="/" class="inline-flex items-center px-4 py-2 mb-8 text-sm font-medium text-white bg-gradient-to-r from-emerald-500 to-teal-500 border border-transparent rounded-md shadow-sm hover:from-emerald-600 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 transition-transform transform hover:-translate-y-0.5">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
      </svg>
      Volver a la Home
    </a>
    <article class="bg-white rounded-lg shadow-md overflow-hidden">
      <Fragment set:html={contentHtml} />
    </article>
  </div>
</MainLayout>